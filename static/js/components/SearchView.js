import * as Utils from '../utils.js';
export default {
    props: ['searchCriteria', 'searchResults', 'searchSummary', 'categories'],
    emits: ['close', 'perform-search', 'clear-filters', 'apply-preset'],
    setup() { return { ...Utils }; },
    template: `
    <div class="fixed inset-0 z-[100] bg-slate-900 flex flex-col animate-fade-in">
        <div class="px-5 pt-14 pb-4 flex justify-between items-center bg-slate-900/90 backdrop-blur border-b border-slate-800 sticky top-0 z-10 safe-top"><h2 class="text-xl font-bold text-white">Szukaj i Analizuj</h2><button @click="$emit('close')" class="text-slate-400 text-sm font-bold bg-slate-800 px-3 py-1.5 rounded-lg">Zamknij</button></div>
        <div class="flex-1 overflow-y-auto p-5 pb-32">
            <div class="space-y-4 mb-6">
                <div class="relative"><input v-model="searchCriteria.q" @keyup.enter="$emit('perform-search')" type="text" placeholder="Szukaj w opisach..." class="w-full bg-slate-800 text-white p-3 pl-10 rounded-xl border border-slate-700 outline-none focus:border-blue-500"><div class="absolute left-3 top-3.5 text-slate-500">üîç</div></div>
                <div class="flex gap-2 overflow-x-auto pb-2 no-scrollbar"><button @click="$emit('apply-preset', 1)" class="whitespace-nowrap px-3 py-1.5 bg-slate-800 rounded-lg text-xs font-bold text-slate-300 border border-slate-700 hover:bg-blue-600 hover:text-white hover:border-blue-500 transition-colors">1 Mies.</button><button @click="$emit('apply-preset', 3)" class="whitespace-nowrap px-3 py-1.5 bg-slate-800 rounded-lg text-xs font-bold text-slate-300 border border-slate-700 hover:bg-blue-600 hover:text-white hover:border-blue-500 transition-colors">3 Mies.</button><button @click="$emit('apply-preset', 6)" class="whitespace-nowrap px-3 py-1.5 bg-slate-800 rounded-lg text-xs font-bold text-slate-300 border border-slate-700 hover:bg-blue-600 hover:text-white hover:border-blue-500 transition-colors">6 Mies.</button><button @click="$emit('apply-preset', 12)" class="whitespace-nowrap px-3 py-1.5 bg-slate-800 rounded-lg text-xs font-bold text-slate-300 border border-slate-700 hover:bg-blue-600 hover:text-white hover:border-blue-500 transition-colors">1 Rok</button><button @click="searchCriteria.date_from=''; searchCriteria.date_to=''" class="whitespace-nowrap px-3 py-1.5 bg-slate-800 rounded-lg text-xs font-bold text-slate-300 border border-slate-700 hover:bg-red-600 hover:text-white hover:border-red-500 transition-colors">Ca≈Ço≈õƒá</button></div>
                <div class="grid grid-cols-2 gap-2"><div class="bg-slate-800 p-2 rounded-xl border border-slate-700"><label class="text-[10px] text-slate-500 uppercase font-bold block pl-1">Od</label><input v-model="searchCriteria.date_from" type="date" class="bg-transparent text-white text-sm w-full outline-none"></div><div class="bg-slate-800 p-2 rounded-xl border border-slate-700"><label class="text-[10px] text-slate-500 uppercase font-bold block pl-1">Do</label><input v-model="searchCriteria.date_to" type="date" class="bg-transparent text-white text-sm w-full outline-none"></div></div>
                <div class="grid grid-cols-2 gap-2"><select v-model="searchCriteria.type" class="bg-slate-800 text-white text-sm p-3 rounded-xl border border-slate-700 outline-none"><option value="all">Wszystkie typy</option><option value="expense">Wydatki</option><option value="income">Przychody</option><option value="transfer">Transfery</option></select><select v-model="searchCriteria.category_id" class="bg-slate-800 text-white text-sm p-3 rounded-xl border border-slate-700 outline-none"><option :value="null">Wszystkie kategorie</option><option v-for="cat in categories" :value="cat.id">{{ cat.name }}</option></select></div>
                <button @click="$emit('perform-search')" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded-xl shadow-lg shadow-blue-900/20 transition-all active:scale-95">Szukaj</button><button @click="$emit('clear-filters')" class="w-full text-slate-500 text-xs font-bold py-2">Wyczy≈õƒá filtry</button>
            </div>
            <div v-if="searchResults !== null" class="animate-fade-in">
                <div class="flex justify-between items-center mb-4"><h3 class="text-slate-400 text-xs font-bold uppercase tracking-wider">Wyniki: {{ searchSummary.count }}</h3></div>
                <div class="grid grid-cols-3 gap-2 mb-6"><div class="bg-green-500/10 border border-green-500/20 p-2 rounded-xl text-center"><div class="text-[10px] text-green-400 font-bold uppercase">Przychody</div><div class="text-sm font-bold text-white">{{ formatMoney(searchSummary.income) }}</div></div><div class="bg-red-500/10 border border-red-500/20 p-2 rounded-xl text-center"><div class="text-[10px] text-red-400 font-bold uppercase">Wydatki</div><div class="text-sm font-bold text-white">{{ formatMoney(searchSummary.expense) }}</div></div><div class="bg-blue-500/10 border border-blue-500/20 p-2 rounded-xl text-center"><div class="text-[10px] text-blue-400 font-bold uppercase">Bilans</div><div class="text-sm font-bold text-white">{{ formatMoney(searchSummary.balance) }}</div></div></div>
                <div class="space-y-3"><div v-if="searchResults.length === 0" class="text-center text-slate-500 py-10">Brak wynik√≥w dla tych kryteri√≥w</div><div v-for="tx in searchResults" :key="tx.id" class="glass-panel p-3 rounded-2xl flex items-center gap-3"><div :class="getIconClass(tx.type)" class="w-10 h-10 rounded-full flex items-center justify-center text-lg relative shrink-0">{{ getIcon(tx.type) }}</div><div class="flex-1 min-w-0"><div class="font-semibold text-slate-200 text-sm truncate pr-1">{{ tx.desc }}</div><div class="text-xs text-slate-500 truncate">{{ tx.category }} ‚Ä¢ {{ formatDateShort(tx.date) }}</div></div><div class="flex flex-col items-end gap-1 shrink-0"><div :class="getColorClass(tx.type)" class="font-bold text-sm whitespace-nowrap">{{ tx.type === 'income' ? '+' : (tx.type === 'transfer' ? '' : '-') }}{{ formatMoney(tx.amount) }}</div></div></div></div>
            </div>
        </div>
    </div>`
}
