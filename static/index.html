<!DOCTYPE html>
<html lang="pl" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Bud≈ºet Domowy</title>
    <link rel="manifest" href="/static/manifest.json">
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="/static/icon_v2.png">
    <link rel="icon" href="/static/icon_v2.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="/static/style.css?v=32">
    <style>
        [v-cloak] { display: none !important; }
        .big-amount-input { background-color: transparent !important; border: none !important; outline: none !important; box-shadow: none !important; text-align: center; font-size: 3rem; font-weight: 800; color: white; width: 100%; padding: 0; margin: 0; }
        .big-amount-input::placeholder { color: #475569; }
        .big-amount-input::-webkit-outer-spin-button, .big-amount-input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        input[type="date"] { background-color: transparent; color: white; font-family: inherit; width: 100%; outline: none; }
        input[type="date"]::-webkit-calendar-picker-indicator { filter: invert(1); opacity: 0.6; cursor: pointer; }
        .type-btn { transition: all 0.2s; border-radius: 10px; font-weight: 600; font-size: 0.85rem; padding: 8px 0; }
        .active-exp { background: #ef4444; color: white; box-shadow: 0 4px 12px rgba(239,68,68,0.3); }
        .active-inc { background: #22c55e; color: white; box-shadow: 0 4px 12px rgba(34,197,94,0.3); }
        .active-trf { background: #3b82f6; color: white; box-shadow: 0 4px 12px rgba(59,130,246,0.3); }
        .inactive-btn { color: #64748b; hover:bg-slate-800; }
        .cat-chip { background: #1e293b; border: 1px solid #334155; color: #94a3b8; padding: 10px; border-radius: 12px; font-size: 0.8rem; font-weight: 600; text-align: center; transition: all 0.2s; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .cat-chip.selected { background: #2563eb; border-color: #3b82f6; color: white; box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="app" class="h-screen flex flex-col bg-slate-900" v-cloak>
        <!-- TOASTS -->
        <div class="fixed top-0 left-0 right-0 z-[100] flex flex-col items-center gap-2 p-4 pointer-events-none safe-top">
            <transition-group name="toast">
                <div v-for="toast in toasts" :key="toast.id" class="pointer-events-auto glass-panel px-4 py-3 rounded-xl shadow-2xl flex items-center gap-3 min-w-[300px] max-w-sm border-l-4 backdrop-blur-md" :class="{'border-green-500': toast.type === 'success', 'border-red-500': toast.type === 'error', 'border-blue-500': toast.type === 'info'}">
                    <div class="text-lg">{{ toast.type === 'success' ? '‚úÖ' : (toast.type === 'error' ? 'üõë' : '‚ÑπÔ∏è') }}</div>
                    <div class="flex-1"><div class="text-xs font-bold uppercase opacity-70" :class="{'text-green-400': toast.type === 'success', 'text-red-400': toast.type === 'error', 'text-blue-400': toast.type === 'info'}">{{ toast.title }}</div><div class="text-sm text-white font-medium leading-tight">{{ toast.message }}</div></div>
                    <button @click="removeToast(toast.id)" class="text-slate-500 hover:text-white transition-colors">√ó</button>
                </div>
            </transition-group>
        </div>

        <!-- LOGIN -->
        <login-view v-if="!isLoggedIn" @login="login"></login-view>

        <!-- APP -->
        <div v-else class="flex-1 flex flex-col h-full relative overflow-hidden">
            <div class="flex-1 overflow-y-auto overflow-x-hidden pb-32 safe-top" @touchstart="handleTouchStart" @touchend="handleTouchEnd">
                <!-- HEADER -->
                <div class="px-5 pt-6 pb-2 flex justify-between items-center">
                    <div class="flex items-center bg-slate-800 rounded-xl p-1 border border-slate-700">
                        <button @click="changePeriod(-1)" class="w-8 h-8 flex items-center justify-center rounded-lg text-slate-400 hover:text-white hover:bg-slate-700 transition-colors">‚óÄ</button>
                        <div class="flex flex-col items-center px-3 cursor-pointer min-w-[100px]" @click="periodOffset = 0; fetchData()"><span class="text-xs font-bold text-slate-200 whitespace-nowrap">{{ formatDateShort(dashboard.period_start) }} - {{ formatDateShort(dashboard.period_end) }}</span><span v-if="periodOffset !== 0" class="text-[9px] text-blue-400 font-bold tracking-wider uppercase">Wr√≥ƒá do dzi≈õ</span></div>
                        <button @click="changePeriod(1)" class="w-8 h-8 flex items-center justify-center rounded-lg text-slate-400 hover:text-white hover:bg-slate-700 transition-colors">‚ñ∂</button>
                    </div>
                    <div class="flex gap-2">
                        <button @click="openSearch" class="w-10 h-10 flex items-center justify-center rounded-xl bg-slate-800 text-slate-400 hover:text-white border border-slate-700">üîç</button>
                        <button @click="currentTab = 'settings'" class="w-10 h-10 flex items-center justify-center rounded-xl bg-slate-800 text-slate-400 hover:text-white border border-slate-700">‚öôÔ∏è</button>
                        <button @click="logout" class="w-10 h-10 flex items-center justify-center rounded-xl bg-slate-800 text-slate-400 hover:text-red-400 border border-slate-700">üö™</button>
                    </div>
                </div>

                <!-- VIEWS -->
                <dashboard-view v-if="currentTab === 'dashboard'" :dashboard="dashboard" :accounts="accounts" :filtered-transactions="filteredTransactions" :grouped-categories="groupedCategories" :expense-categories="expenseCategories" :budget-ranking="budgetRanking" v-model:view-mode="viewMode" v-model:budget-ranking-expanded="budgetRankingExpanded" v-model:filter-status="filterStatus" v-model:filter-account="filterAccount" v-model:selected-chart-segment="selectedChartSegment" :chart-colors="chartColors" @change-period="changePeriod" @realize-tx="realizeTx" @copy-tx="copyTx" @edit-tx="editTx" @delete-tx="deleteTx" @open-category="openCategoryDetails" @render-charts="renderChart"></dashboard-view>
                <accounts-view v-if="currentTab === 'accounts'" :accounts="accounts" @create-account="createTestAccount" @edit-account="editAccount" @delete-account="deleteAccount" @trigger-import="triggerImport"></accounts-view>
                <goals-view v-if="currentTab === 'goals'" :goals="goals" :savings-accounts="savingsAccounts" v-model:show-add-goal="showAddGoal" :new-goal="newGoal" @submit-goal="submitGoal" @delete-goal="deleteGoal" @open-fund="openFundGoal" @edit-goal="editGoal" @open-withdraw="openWithdrawGoal" @open-transfer="openTransferGoal"></goals-view>
                <payments-view v-if="currentTab === 'payments'" :filtered-loans="filteredLoans" v-model:show-paid-loans="showPaidLoans" v-model:show-add-loan="showAddLoan" :new-loan="newLoan" v-model:show-add-recurring="showAddRecurring" :new-recurring="newRecurring" :recurring-list="recurringList" :accounts="accounts" :filtered-categories="filteredCategories" v-model:category-search="categorySearch" @submit-loan="submitLoan" @edit-loan="editLoan" @submit-recurring="submitRecurring" @delete-recurring="deleteRecurring"  @edit-recurring="editRecurring"></payments-view>
                <settings-view v-if="currentTab === 'settings'" :categories="categories" :overrides="overrides" v-model:new-category-name="newCategoryName" :new-override="newOverride" :security="security" @add-category="addCategory" @update-category="updateCategory" @delete-category="deleteCategory" @add-override="addOverride" @delete-override="deleteOverride" @change-password="changePassword" @register-user="registerUser"></settings-view>
                <add-transaction-view v-if="currentTab === 'add'" :new-tx="newTx" :accounts="accounts" :active-loans="activeLoans" :filtered-categories="filteredCategories" v-model:category-search="categorySearch" :editing-tx-id="editingTxId" v-model:is-planned="isPlanned" @submit-transaction="submitTransaction" @cancel-edit="cancelEdit" @detect-category="detectCategory" @handle-loan-change="handleLoanChange"></add-transaction-view>
            </div>

            <!-- NAVIGATION -->
            <the-navigation
                v-if="isLoggedIn"
                v-model:current-tab="currentTab"
                :loan-alerts-count="loanAlertsCount"
                @open-add="resetForm(); currentTab = 'add'">
            </the-navigation>

            <!-- MODALS -->
            <search-view v-if="showSearch" :search-criteria="searchCriteria" :search-results="searchResults" :search-summary="searchSummary" :categories="categories" @close="closeSearch" @perform-search="performSearch" @clear-filters="clearSearchFilters" @apply-preset="applyDatePreset"></search-view>
            <import-modal v-if="importData" :import-data="importData" :categories="categories" @close="importData = null" @submit="submitImport"></import-modal>
            
            <!-- INNE MODALE (POZOSTA≈ÅE) -->
            <div v-if="selectedCategory" class="fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4" @click.self="selectedCategory = null">
                <div class="glass-panel w-full max-w-md rounded-2xl p-5 h-[85vh] flex flex-col">
                    
                    <!-- Header -->
                    <div class="flex justify-between items-center mb-4 shrink-0">
                        <h3 class="text-xl font-bold text-white">{{ selectedCategory.name }}</h3>
                        <button @click="selectedCategory = null; categoryModalTab = 'budget'" class="text-slate-400 text-2xl hover:text-white">&times;</button>
                    </div>
                    
                    <!-- Zak≈Çadki -->
                    <div class="flex bg-slate-800/50 rounded-xl p-1 mb-4 shrink-0">
                        <button @click="categoryModalTab = 'overview'"
                                :class="categoryModalTab === 'overview' ? 'bg-slate-600 text-white' : 'text-slate-400'"
                                class="flex-1 py-2 rounded-lg text-xs font-bold transition-colors">
                                    üìä PrzeglƒÖd
                                </button>
                                <button @click="categoryModalTab = 'transactions'"
                                        :class="categoryModalTab === 'transactions' ? 'bg-slate-600 text-white' : 'text-slate-400'"
                                        class="flex-1 py-2 rounded-lg text-xs font-bold transition-colors">
                                    üìã Transakcje ({{ selectedCategory.transactions.length }})
                                </button>
                            </div>
                    
                    <!-- ZAK≈ÅADKA: PrzeglƒÖd (Bud≈ºet + Trend) -->
                    <div v-if="categoryModalTab === 'overview'" class="flex-1 overflow-y-auto">
                        
                        <!-- Bud≈ºet -->
                        <div class="bg-slate-800 p-3 rounded-xl border border-slate-700 mb-4">
                            <label class="text-xs text-slate-400 uppercase font-bold block mb-1">Miesiƒôczny Bud≈ºet</label>
                            <div class="flex gap-2">
                                <input type="number" v-model="selectedCategory.limit" class="input-dark flex-1 p-2 rounded-lg text-sm" placeholder="Brak limitu">
                                <button @click="updateCategoryLimit(selectedCategory)" class="bg-blue-600 text-white px-3 rounded-lg text-xs font-bold">Zapisz</button>
                            </div>
                        </div>
                        
                        <!-- Statystyki -->
                        <div class="grid grid-cols-2 gap-2 mb-4">
                            <div class="bg-slate-800/50 p-3 rounded-xl border border-slate-700">
                                <div class="text-xs text-slate-400">Wydane</div>
                                <div class="text-xl font-bold text-white">{{ formatMoney(Math.abs(selectedCategory.total)) }}</div>
                            </div>
                            <div v-if="selectedCategory.limit > 0" class="bg-slate-800/50 p-3 rounded-xl border border-slate-700">
                                <div class="text-xs text-slate-400">Pozosta≈Ço</div>
                                <div class="text-xl font-bold" :class="selectedCategory.limit - Math.abs(selectedCategory.total) > 0 ? 'text-green-400' : 'text-red-400'">
                                    {{ formatMoney(Math.max(0, selectedCategory.limit - Math.abs(selectedCategory.total))) }}
                                </div>
                            </div>
                        </div>
                        
                        <!-- Trend -->
                        <div v-if="categoryTrend" class="bg-slate-800/50 p-4 rounded-xl border border-slate-700">
                            <h4 class="text-xs text-slate-400 uppercase font-bold mb-3">üìà Trend 6 miesiƒôcy</h4>
                            
                            <div class="space-y-2 mb-3">
                                <div v-for="month in categoryTrend.trend" :key="month.label" class="flex items-center gap-2">
                                    <span class="text-xs text-slate-400 w-8 shrink-0">{{ month.label }}</span>
                                    <div class="flex-1 h-6 bg-slate-700/50 rounded-lg overflow-hidden relative">
                                        <div
                                            class="h-full rounded-lg transition-all duration-500"
                                            :class="month.amount > categoryTrend.current_limit ? 'bg-red-500' : (month.amount > categoryTrend.current_limit * 0.8 ? 'bg-yellow-500' : 'bg-green-500')"
                                            :style="{ width: categoryTrend.current_limit > 0 ? Math.min(100, (month.amount / categoryTrend.current_limit) * 100) + '%' : '0%' }">
                                        </div>
                                        <span class="absolute right-2 top-1/2 -translate-y-1/2 text-[10px] text-white font-bold drop-shadow">
                                            {{ Math.round(month.amount) }}
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-2 text-xs mb-3">
                                <div class="bg-slate-900/50 p-2 rounded">
                                    <div class="text-slate-500">≈örednia</div>
                                    <div class="font-bold text-white">{{ formatMoney(categoryTrend.average) }}</div>
                                </div>
                                <div class="bg-slate-900/50 p-2 rounded">
                                    <div class="text-slate-500">Obecny limit</div>
                                    <div class="font-bold" :class="categoryTrend.current_limit > 0 ? 'text-blue-400' : 'text-slate-600'">
                                        {{ categoryTrend.current_limit > 0 ? formatMoney(categoryTrend.current_limit) : 'Brak' }}
                                    </div>
                                </div>
                            </div>
                            
                            <div v-if="categoryTrend.suggested_limit > 0 && Math.abs(categoryTrend.suggested_limit - categoryTrend.current_limit) > 50"
                                 class="p-2 bg-blue-900/20 border border-blue-500/30 rounded-lg">
                                <div class="text-xs text-blue-300">
                                    üí° Sugerowany limit: <span class="font-bold">{{ formatMoney(categoryTrend.suggested_limit) }}</span>
                                </div>
                            </div>
                        </div>
                        <div v-else class="text-center py-10 text-slate-500 text-sm">
                            ≈Åadowanie trendu...
                        </div>
                    </div>

                    <!-- ZAK≈ÅADKA: Transakcje -->
                    <div v-if="categoryModalTab === 'transactions'" class="flex-1 overflow-y-auto pr-1">
                        <div class="space-y-2">
                            <div v-for="tx in selectedCategory.transactions" :key="tx.id"
                                 @click="editTxFromModal(tx)"
                                 class="flex justify-between items-center border-b border-slate-700/50 pb-2 last:border-0 transition-all cursor-pointer hover:bg-white/5 p-2 rounded-lg"
                                 :class="{'opacity-60': tx.status === 'planowana'}">
                                <div class="flex items-center gap-3 min-w-0">
                                    <div class="shrink-0">
                                        <div v-if="tx.status === 'planowana'" class="w-2.5 h-2.5 bg-yellow-500 rounded-full shadow-[0_0_5px_rgba(234,179,8,0.5)]" title="Planowana"></div>
                                        <div v-else class="w-2.5 h-2.5 bg-slate-700 rounded-full"></div>
                                    </div>
                                    <div class="min-w-0">
                                        <div class="text-sm text-slate-200 truncate font-medium">{{ tx.desc }}</div>
                                        <div class="text-[10px] text-slate-500">{{ formatDateShort(tx.date) }}</div>
                                    </div>
                                </div>
                                <div class="flex items-center gap-3 shrink-0 pl-2">
                                    <div :class="tx.type === 'expense' ? 'text-red-400' : 'text-green-400'" class="font-bold text-sm whitespace-nowrap">
                                        {{ formatMoney(tx.amount) }}
                                    </div>
                                    <button v-if="tx.status === 'planowana'" @click.stop="realizeTxFromModal(tx)"
                                            class="w-8 h-8 flex items-center justify-center bg-green-500/20 text-green-400 rounded hover:bg-green-500 hover:text-white transition-colors border border-green-500/30" title="Zrealizuj">‚úì</button>
                                    <div class="text-slate-500 text-lg">‚Ä∫</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
            <div v-if="editingLoan" class="fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4" @click.self="editingLoan = null"><div class="glass-panel w-full max-w-md rounded-2xl p-5"><h3 class="text-xl font-bold text-white mb-4">Edytuj Kredyt</h3><div class="space-y-3"><input v-model="editingLoan.name" placeholder="Nazwa" class="input-dark w-full max-w-full p-3 rounded-xl text-base outline-none bg-transparent appearance-none"><input v-model="editingLoan.total_amount" type="number" placeholder="Kwota ca≈Çk." class="input-dark w-full max-w-full p-3 rounded-xl text-base outline-none bg-transparent appearance-none"><input v-model="editingLoan.remaining_amount" type="number" placeholder="Pozosta≈Ço" class="input-dark w-full max-w-full p-3 rounded-xl text-base outline-none bg-transparent appearance-none"><input v-model="editingLoan.monthly_payment" type="number" placeholder="Rata" class="input-dark w-full max-w-full p-3 rounded-xl text-base outline-none bg-transparent appearance-none"><input v-model="editingLoan.next_payment_date" type="date" class="input-dark w-full max-w-full p-3 rounded-xl text-base outline-none bg-transparent appearance-none"><button @click="updateLoan" class="w-full bg-blue-600 py-3 rounded-xl font-bold text-sm">Zapisz zmiany</button></div></div></div>
            <div v-if="fundingGoal" class="fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4" @click.self="fundingGoal = null"><div class="glass-panel w-full max-w-md rounded-2xl p-5"><h3 class="text-xl font-bold text-white mb-4">Zasil cel: {{ fundingGoal.name }}</h3><div class="space-y-3"><label class="text-xs text-slate-400 uppercase font-bold">Z konta</label><select v-model="fundData.source_account_id" class="input-dark w-full max-w-full p-3 rounded-xl text-base outline-none bg-transparent appearance-none"><option v-for="acc in accounts" :value="acc.id">{{ acc.name }} ({{ formatMoney(acc.available) }}) {{ acc.is_savings ? 'üîí' : 'üí≥' }}</option></select><div v-if="isSourceROR" class="bg-blue-900/20 p-3 rounded-xl border border-blue-500/30"><label class="text-xs text-blue-300 uppercase font-bold mb-1 block">Automatyczny transfer na:</label><select v-model="fundData.target_savings_id" class="input-dark w-full max-w-full p-2 rounded-lg text-sm outline-none bg-slate-900 appearance-none"><option v-for="acc in savingsAccounts" :value="acc.id">{{ acc.name }}</option></select><div class="text-[10px] text-blue-400 mt-1">System automatycznie przeleje ≈õrodki na to konto oszczƒôdno≈õciowe.</div></div><input v-model="fundData.amount" type="number" placeholder="Kwota" class="input-dark w-full max-w-full p-3 rounded-xl text-base outline-none bg-transparent appearance-none"><button @click="submitFundGoal" class="w-full bg-green-600 py-3 rounded-xl font-bold text-sm">Zasil Cel</button></div></div></div>
            <div v-if="transferingGoal" class="fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4" @click.self="transferingGoal = null"><div class="glass-panel w-full max-w-md rounded-2xl p-5"><h3 class="text-xl font-bold text-white mb-4">Przenie≈õ z: {{ transferingGoal.name }}</h3><div class="space-y-3"><label class="text-xs text-slate-400 uppercase font-bold">Na cel</label><select v-model="transferData.target_goal_id" class="input-dark w-full max-w-full p-3 rounded-xl text-base outline-none bg-transparent appearance-none"><option v-for="g in goals.filter(g => g.id !== transferingGoal.id)" :value="g.id">{{ g.name }}</option></select><input v-model="transferData.amount" type="number" placeholder="Kwota" class="input-dark w-full max-w-full p-3 rounded-xl text-base outline-none bg-transparent appearance-none"><button @click="submitTransferGoal" class="w-full bg-blue-600 py-3 rounded-xl font-bold text-sm">Przenie≈õ</button></div></div></div>
            <div v-if="withdrawingGoal" class="fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4" @click.self="withdrawingGoal = null"><div class="glass-panel w-full max-w-md rounded-2xl p-5"><h3 class="text-xl font-bold text-white mb-4">Wyp≈Çaƒá z: {{ withdrawingGoal.name }}</h3><div class="space-y-3"><div class="bg-slate-800 p-3 rounded-xl border border-slate-700 mb-2"><div class="text-xs text-slate-400 uppercase font-bold">Dostƒôpne ≈õrodki</div><div class="text-lg font-bold text-green-400">{{ formatMoney(withdrawingGoal.current_amount) }}</div></div><label class="text-xs text-slate-400 uppercase font-bold">Przelej na konto</label><select v-model="withdrawData.target_account_id" class="input-dark w-full max-w-full p-3 rounded-xl text-base outline-none bg-transparent appearance-none"><option v-for="acc in accounts" :value="acc.id">{{ acc.name }} ({{ formatMoney(acc.balance) }})</option></select><input v-model="withdrawData.amount" type="number" placeholder="Kwota do wyp≈Çaty" class="input-dark w-full max-w-full p-3 rounded-xl text-base outline-none bg-transparent appearance-none"><div class="flex gap-2 mt-2"><button @click="withdrawData.amount = withdrawingGoal.current_amount" class="text-xs text-blue-400 font-bold py-2 px-3 bg-slate-800 rounded-lg border border-slate-700">Ca≈Ço≈õƒá</button></div><button @click="submitWithdrawGoal" class="w-full bg-red-600 hover:bg-red-500 py-3 rounded-xl font-bold text-sm mt-2 text-white shadow-lg shadow-red-900/20">Potwierd≈∫ wyp≈Çatƒô</button></div></div></div>
            <div v-if="isLoggedIn && duePayments.length > 0" class="fixed inset-0 z-[70] bg-black/90 backdrop-blur-md flex items-center justify-center p-4"><div class="glass-panel w-full max-w-md rounded-2xl p-6 border border-blue-500/50"><h3 class="text-xl font-bold text-white mb-2">üîî P≈Çatno≈õci cykliczne</h3><p class="text-sm text-slate-400 mb-4">Poni≈ºsze op≈Çaty sƒÖ wymagalne w tym miesiƒÖcu. Czy chcesz je dodaƒá?</p><div class="space-y-2 max-h-[50vh] overflow-y-auto mb-4"><div v-for="pay in duePayments" :key="pay.id" class="bg-slate-800 p-3 rounded-xl flex justify-between items-center"><div><div class="font-bold text-white text-sm">{{ pay.name }}</div><div class="text-xs text-slate-400">{{ pay.category }}</div></div><div class="flex items-center gap-3"><div class="font-bold text-white">{{ formatMoney(pay.amount) }}</div><button @click="skipRecurring(pay)" class="bg-slate-700 text-slate-400 w-8 h-8 rounded-full flex items-center justify-center font-bold hover:bg-slate-600 hover:text-white transition-colors" title="Pomi≈Ñ w tym miesiƒÖcu">‚úï</button><button @click="processRecurring(pay)" class="bg-green-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold hover:bg-green-500 transition-colors" title="Dodaj do planowanych">‚úì</button></div></div></div><button @click="duePayments = []" class="w-full py-3 text-slate-400 text-sm font-bold">Zamknij (Zrobiƒô to p√≥≈∫niej)</button></div></div>
            
            <!-- Modal Edycji Celu -->
            <div v-if="editingGoal" class="fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4" @click.self="editingGoal = null">
                <div class="glass-panel w-full max-w-md rounded-2xl p-5">
                    <h3 class="text-xl font-bold text-white mb-4">Edytuj Cel</h3>
                    <div class="space-y-3">
                        <input v-model="editingGoal.name" placeholder="Nazwa celu" class="input-dark w-full p-3 rounded-xl">
                        
                        <label class="text-xs text-slate-400 uppercase font-bold">Konto oszczƒôdno≈õciowe</label>
                        <select v-model="editingGoal.account_id" class="input-dark w-full p-3 rounded-xl">
                            <option v-for="acc in savingsAccounts" :value="acc.id">{{ acc.name }}</option>
                        </select>
                        
                        <label class="text-xs text-slate-400 uppercase font-bold">Kwota docelowa</label>
                        <input v-model="editingGoal.target_amount" type="number" class="input-dark w-full p-3 rounded-xl">
                        
                        <label class="text-xs text-slate-400 uppercase font-bold">Termin</label>
                        <input v-model="editingGoal.deadline" type="date" class="input-dark w-full p-3 rounded-xl">
                        
                        <button @click="submitUpdateGoal" class="w-full bg-blue-600 py-3 rounded-xl font-bold text-sm mt-2">Zapisz zmiany</button>
                    </div>
                </div>
            </div>
            
            <loan-alerts-modal
                v-if="showLoanAlerts"
                :alerts="loanAlerts"
                :accounts="accounts"
                @close="showLoanAlerts = false"
                @add-to-planned="addLoanPaymentsToPlanned"
                @dismiss-until-tomorrow="dismissLoanAlertsUntilTomorrow">
            </loan-alerts-modal>
            
        </div>
    </div>
    <script type="module" src="/static/js/main.js?v=83"></script>
</body>
</html>
